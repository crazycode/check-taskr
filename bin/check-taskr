#!/usr/bin/env ruby
# -*- coding: utf-8 -*-

# for development
$LOAD_PATH.unshift(File.dirname(__FILE__))
$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '..', 'lib'))

require 'rubygems'
require 'sinatra'

require 'log4r'
require "log4r/outputter/datefileoutputter"
include Log4r
require "check-taskr"

filename = "jobs"
logdir = "./logs"
if ARGV.size > 0
  filename = ARGV[0]
  logdir = File.dirname(File.realdirpath(filename)) + "/logs"
end

CheckTaskr::Cli.execute(filename, :logdir => logdir)
config = CheckTaskr::JobsConfiguration.instance

CheckTaskr::App.run! :port => config.listen_port
